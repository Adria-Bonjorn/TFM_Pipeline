params.gatk = "$baseDir/GenomeAnalysisTK.jar"

docker.enabled = true
docker.runOptions = "-v ${params.gatk}:${params.gatk}"
process.container = "cbcrg/callings-nf@sha256:b65a7d721b9dd2da07d6bdd7f868b04039860f14fa514add975c59e68614c310"

profiles {

    aws {
         params {
             genome    = "s3://cbcrg-eu/callings-data/Homo_sapiens.GRCh37.chromosomes.chr22.fa"
             reads     = "s3://cbcrg-eu/callings-data/rep??_{1,2}.fq.gz"
             variants  = "s3://cbcrg-eu/callings-data/NA12878.chr22.vcf.gz"
             blacklist = "s3://cbcrg-eu/callings-data/ENCFF001TDO.sorted.bed"
             results = "s3://cbcrg-eu/callings-results"
         }
    }

    small_dataset {
        params {
            genome    = "/no_backup/rg/avlasova/NGS_2017/refs/Homo_sapiens.GRCh37.chromosomes.chr22.fa"
            reads     = "/no_backup/rg/avlasova/NGS_2017/rnaseq/rep??_{1,2}.fq.gz"
            variants  = "/no_backup_isis/rg/avlasova/NGS_2017/snv/NA12878.chr22.vcf.gz"
            blacklist = "/no_backup_isis/rg/avlasova/NGS_2017/refs/ENCFF001TDO.sorted.bed"
        }
    }

    cluster_large_dataset {
        params {
            genome    = "$baseDir/data/genome.fa"
            reads     = "$baseDir/data/reads/sample*_{1,2}.fq.gz"
            variants  = "$baseDir/data/known_variants.vcf.gz"
            blacklist = "$baseDir/data/blacklist.bed"
        }

        process {
            executor = 'crg'
            penv = 'smp'
            queue = 'cn-el7'
            memory = 16.GB
            errorStrategy = 'finish'
            scratch=true

            $1C_prepare_genome_picard {
                memory = 64.GB
            }

            $1A_prepare_star_genome_index {
                cpus = 2
                memory = 16.GB
            }

            $2_rnaseq_mapping_star {
                cpus = 2
                memory = 16.GB
            }

            $3_rnaseq_gatk_splitNcigar {
                memory = 48.GB
            }

            $4_rnaseq_gatk_recalibrate {
                memory = 48.GB
            }

            $5_rnaseq_call_variants {
                memory = 48.GB
            }

            $6C_ASE_knownSNPs {
                memory = 48.GB
            }
        }

    }
}

